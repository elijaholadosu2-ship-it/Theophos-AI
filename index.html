<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theophos AI | Deep Assignment Architect</title>
    <style>
        :root { --bg: #0f172a; --primary: #1e293b; --accent: #3b82f6; --text: #f8fafc; --success: #10b981; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 20px; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; background: var(--primary); padding: 40px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        h1 { text-align: center; color: var(--accent); margin: 0; font-size: 2rem; }
        .status-bar { display: flex; justify-content: space-between; margin: 20px 0; font-size: 0.8rem; opacity: 0.6; border-bottom: 1px solid #334155; padding-bottom: 10px; }
        
        label { display: block; margin-top: 20px; font-weight: bold; color: var(--accent); text-transform: uppercase; font-size: 0.75rem; letter-spacing: 1px; }
        select, input { width: 100%; padding: 15px; margin-top: 8px; border-radius: 10px; border: 1px solid #334155; background: #0f172a; color: white; font-size: 1rem; }
        
        .btn { background: var(--accent); color: white; border: none; padding: 20px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; margin-top: 30px; font-size: 1.1rem; transition: 0.3s; }
        .btn:hover { background: #2563eb; transform: translateY(-2px); }
        
        #output-area { display: none; margin-top: 40px; }
        .paper-view { background: white; color: #1a1a1b; padding: 50px; border-radius: 5px; font-family: 'Georgia', serif; line-height: 1.8; box-shadow: inset 0 0 10px rgba(0,0,0,0.1); height: 500px; overflow-y: scroll; }
        .word-count-badge { background: var(--success); color: white; padding: 5px 12px; border-radius: 20px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>THEOPHOS ARCHITECT üèõÔ∏è</h1>
    <div class="status-bar">
        <span>Target: 1,500+ Words</span>
        <span>Mode: Deep Research & Composition</span>
    </div>

    <label>Primary Textbook</label>
    <select id="main-book">
        <option>Loyalty and Disloyalty</option>
        <option>The Art of Shepherding</option>
        <option>The Model Marriage</option>
        <option>The Art of Leadership</option>
        <option>Transform Your Pastoral Ministry</option>
        <option>The Art of Hearing</option>
        <option>Catch the Anointing</option>
        <option>Steps to the Anointing</option>
        <option>He That Hath to Him Shall Be Given</option>
    </select>

    <label>Chapter / Specific Topic</label>
    <input type="text" id="chapter" placeholder="e.g. Chapter 7: The Stages of Disloyalty">

    <label>3 Assignment Points (The AI will expand these into chapters)</label>
    <input type="text" id="p1" placeholder="Point 1 (e.g. The Independent Spirit)" style="margin-bottom: 10px;">
    <input type="text" id="p2" placeholder="Point 2 (e.g. The Critical Stage)" style="margin-bottom: 10px;">
    <input type="text" id="p3" placeholder="Point 3 (e.g. Open Rebellion)">

    <button class="btn" onclick="generateDeepAssignment()">Composing 1,500+ Word Assignment...</button>

    <div id="output-area">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <span class="word-count-badge" id="w-count">0 Words</span>
            <button onclick="downloadDoc()" style="background: var(--success); color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold;">üíæ Download .doc</button>
        </div>
        <div id="paper" class="paper-view"></div>
    </div>
</div>

<script>
    const API_KEY = "AIzaSyCGIeGZP8vWmONgQmtkNQduUDWJyAArAkg";

    async function generateDeepAssignment() {
        const book = document.getElementById('main-book').value;
        const chapter = document.getElementById('chapter').value;
        const p1 = document.getElementById('p1').value;
        const p2 = document.getElementById('p2').value;
        const p3 = document.getElementById('p3').value;
        const paper = document.getElementById('paper');
        const outputArea = document.getElementById('output-area');

        if(!p1 || !p2 || !p3) return alert("Please input all 3 points for the deep expansion.");

        outputArea.style.display = 'block';
        paper.innerHTML = "<em>Theophos is performing deep cross-referencing... analyzing supporting Bishop Dag books... writing Introduction...</em>";

        // This prompt is engineered to FORCE a high word count and specific structure
        const deepPrompt = `Write a professional, academic ministry assignment for a Bible School. 
        PRIMARY BOOK: "${book}" 
        TOPIC: "${chapter}"
        
        REQUIREMENTS:
        1. TOTAL LENGTH: Minimum 1,500 words.
        2. STRUCTURE: 
           - Academic Cover Header.
           - Deep Introduction (200 words).
           - CHAPTER 1: Exhaustive analysis of "${p1}" including 2 additional scriptures and a reference to another Bishop Dag book like 'The Art of Hearing' or 'Steps to the Anointing'.
           - CHAPTER 2: Exhaustive analysis of "${p2}" with ministry applications.
           - CHAPTER 3: Exhaustive analysis of "${p3}".
           - ILLUSTRATION SECTION: Write a 300-word original story/illustration of a pastor or leader applying these truths.
           - CONCLUSION: Summary of the eternal impact of these truths.
        3. TONE: Intellectual, Spiritual, and Loyal to the teachings of Bishop Dag Heward-Mills.
        
        DO NOT summarize. Expand every point with deep theological reasoning.`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: deepPrompt }] }] })
            });

            const data = await response.json();
            const result = data.candidates[0].content.parts[0].text;
            
            // Format for web view
            paper.innerText = result;
            
            // Calculate Word Count
            const words = result.split(/\s+/).length;
            document.getElementById('w-count').innerText = words + " Words";

        } catch (error) {
            paper.innerHTML = "<span style='color:red;'>Connection Error. Please ensure your API Key is active.</span>";
        }
    }

    function downloadDoc() {
        const content = document.getElementById('paper').innerText;
        const blob = new Blob(['\ufeff', content], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = "Deep_Anagkazo_Assignment.doc";
        link.click();
    }
</script>

</body>
</html>
